<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="AVX WebSocket - Implementa√ß√£o WebSocket de alta performance">
    <title>AVX WebSocket - Documenta√ß√£o</title>
    <link rel="stylesheet" href="../assets/css/main.css">
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo"><a href="../index.html" style="text-decoration:none;color:inherit;">AVX Network</a></div>
                <div class="controls">
                    <button id="theme-toggle" class="theme-toggle">üåô</button>
                    <select id="lang-select" class="lang-select">
                        <option value="pt-BR">üáßüá∑ Portugu√™s</option>
                        <option value="ru">üá∑üá∫ –†—É—Å—Å–∫–∏–π</option>
                        <option value="ja">üáØüáµ Êó•Êú¨Ë™û</option>
                        <option value="zh-TW">üáπüáº ÁπÅÈ´î‰∏≠Êñá</option>
                        <option value="ur">üáµüá∞ ÿßÿ±ÿØŸà</option>
                        <option value="ar">üá∏üá¶ ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</option>
                        <option value="de">üá©üá™ Deutsch</option>
                        <option value="lv">üá±üáª Latvie≈°u</option>
                        <option value="uz">üá∫üáø O'zbek</option>
                        <option value="es">üá™üá∏ Espa√±ol</option>
                    </select>
                </div>
            </div>
        </div>
    </header>

    <nav>
        <div class="container">
            <ul class="nav-links">
                <li><a href="#overview">Vis√£o Geral</a></li>
                <li><a href="#types">Tipos Dispon√≠veis</a></li>
                <li><a href="#examples">Exemplos</a></li>
                <li><a href="#api">API</a></li>
                <li><a href="#performance">Performance</a></li>
                <li><a href="#usecases">Casos de Uso</a></li>
            </ul>
        </div>
    </nav>

    <main>
        <div class="container">
            <div class="hero">
                <h1>üîå AVX WebSocket</h1>
                <p>Implementa√ß√£o WebSocket nativa de alta performance com suporte completo ao protocolo RFC 6455</p>
            </div>

            <section id="overview" class="section fade-in">
                <h2>üìã Vis√£o Geral</h2>
                <p>AVX WebSocket √© uma implementa√ß√£o completa do protocolo WebSocket (RFC 6455), constru√≠da do zero para m√°xima performance e compatibilidade. Oferece comunica√ß√£o bidirecional full-duplex sobre TCP com suporte a frames de texto e bin√°rios, fragmenta√ß√£o, ping/pong e fechamento gracioso.</p>

                <div class="modules-grid mt-3">
                    <div class="module-card">
                        <h3>‚ö° Ultra Performance</h3>
                        <p>200k+ frames/s com lat√™ncia < 100Œºs e zero-copy parsing</p>
                    </div>
                    <div class="module-card">
                        <h3>üîí RFC 6455 Compliant</h3>
                        <p>Implementa√ß√£o completa seguindo especifica√ß√£o oficial</p>
                    </div>
                    <div class="module-card">
                        <h3>üéØ Full-Duplex</h3>
                        <p>Comunica√ß√£o bidirecional simult√¢nea sem bloqueio</p>
                    </div>
                    <div class="module-card">
                        <h3>üöÄ Completo</h3>
                        <p>Text, binary, ping/pong, close e fragmenta√ß√£o</p>
                    </div>
                </div>
            </section>

            <section id="types" class="section fade-in">
                <h2>üì¶ Tipos Dispon√≠veis</h2>

                <h3>Core</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Tipo</th>
                            <th>Descri√ß√£o</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>Frame</code></td>
                            <td>Frame WebSocket com opcode e payload</td>
                        </tr>
                        <tr>
                            <td><code>OpCode</code></td>
                            <td>C√≥digos de opera√ß√£o (Text, Binary, Close, Ping, Pong)</td>
                        </tr>
                        <tr>
                            <td><code>WebSocketServer</code></td>
                            <td>Servidor WebSocket ass√≠ncrono</td>
                        </tr>
                        <tr>
                            <td><code>WebSocketClient</code></td>
                            <td>Cliente WebSocket com auto-reconnect</td>
                        </tr>
                        <tr>
                            <td><code>Connection</code></td>
                            <td>Conex√£o WebSocket estabelecida</td>
                        </tr>
                    </tbody>
                </table>

                <h3 class="mt-3">OpCodes</h3>
                <table>
                    <thead>
                        <tr>
                            <th>OpCode</th>
                            <th>Valor</th>
                            <th>Descri√ß√£o</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>Text</code></td>
                            <td>1</td>
                            <td>Frame de texto UTF-8</td>
                        </tr>
                        <tr>
                            <td><code>Binary</code></td>
                            <td>2</td>
                            <td>Frame de dados bin√°rios</td>
                        </tr>
                        <tr>
                            <td><code>Close</code></td>
                            <td>8</td>
                            <td>Fechamento de conex√£o</td>
                        </tr>
                        <tr>
                            <td><code>Ping</code></td>
                            <td>9</td>
                            <td>Ping para keep-alive</td>
                        </tr>
                        <tr>
                            <td><code>Pong</code></td>
                            <td>10</td>
                            <td>Resposta ao ping</td>
                        </tr>
                        <tr>
                            <td><code>Continuation</code></td>
                            <td>0</td>
                            <td>Continua√ß√£o de frame fragmentado</td>
                        </tr>
                    </tbody>
                </table>

                <h3 class="mt-3">Handshake</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Tipo</th>
                            <th>Descri√ß√£o</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>HandshakeRequest</code></td>
                            <td>Requisi√ß√£o de upgrade HTTP para WebSocket</td>
                        </tr>
                        <tr>
                            <td><code>HandshakeResponse</code></td>
                            <td>Resposta de upgrade do servidor</td>
                        </tr>
                        <tr>
                            <td><code>Extensions</code></td>
                            <td>Extens√µes WebSocket negociadas</td>
                        </tr>
                    </tbody>
                </table>

                <h3 class="mt-3">Close Status Codes</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Code</th>
                            <th>Nome</th>
                            <th>Descri√ß√£o</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>1000</td>
                            <td><code>NORMAL_CLOSURE</code></td>
                            <td>Fechamento normal</td>
                        </tr>
                        <tr>
                            <td>1001</td>
                            <td><code>GOING_AWAY</code></td>
                            <td>Endpoint est√° indo embora</td>
                        </tr>
                        <tr>
                            <td>1002</td>
                            <td><code>PROTOCOL_ERROR</code></td>
                            <td>Erro de protocolo</td>
                        </tr>
                        <tr>
                            <td>1003</td>
                            <td><code>UNSUPPORTED_DATA</code></td>
                            <td>Dados n√£o suportados</td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <section id="examples" class="section fade-in">
                <h2>üí° Exemplos de Uso</h2>

                <h3>Criar Frame de Texto</h3>
                <pre><code>use avx_websocket::{Frame, OpCode};

let frame = Frame::new(
    OpCode::Text,
    b"Hello, WebSocket!".to_vec()
);

// Serializar para envio
let bytes = frame.to_bytes();</code></pre>

                <h3>Criar Frame Bin√°rio</h3>
                <pre><code>use avx_websocket::{Frame, OpCode};

let data = vec![0x01, 0x02, 0x03, 0x04];
let frame = Frame::new(OpCode::Binary, data);

// Enviar pela conex√£o
connection.send(frame).await?;</code></pre>

                <h3>Ping/Pong Keep-Alive</h3>
                <pre><code>use avx_websocket::{Frame, OpCode};

// Enviar ping
let ping = Frame::new(OpCode::Ping, vec![]);
connection.send(ping).await?;

// Responder automaticamente com pong
// (geralmente feito automaticamente pelo servidor)
let pong = Frame::new(OpCode::Pong, vec![]);
connection.send(pong).await?;</code></pre>

                <h3>Servidor WebSocket Simples</h3>
                <pre><code>use avx_websocket::{WebSocketServer, OpCode};

#[tokio::main]
async fn main() -> Result<()> {
    let server = WebSocketServer::bind("0.0.0.0:8080").await?;

    println!("WebSocket server listening on :8080");

    while let Ok((mut connection, addr)) = server.accept().await {
        tokio::spawn(async move {
            println!("Client connected: {}", addr);

            while let Some(frame) = connection.recv().await {
                match frame.opcode {
                    OpCode::Text => {
                        let text = String::from_utf8_lossy(&frame.payload);
                        println!("Received: {}", text);

                        // Echo back
                        connection.send(frame).await.unwrap();
                    }
                    OpCode::Close => {
                        println!("Client disconnected");
                        break;
                    }
                    _ => {}
                }
            }
        });
    }

    Ok(())
}</code></pre>

                <h3>Cliente WebSocket</h3>
                <pre><code>use avx_websocket::{WebSocketClient, Frame, OpCode};

#[tokio::main]
async fn main() -> Result<()> {
    let mut client = WebSocketClient::connect("ws://localhost:8080").await?;

    // Enviar mensagem
    let frame = Frame::text("Hello, Server!");
    client.send(frame).await?;

    // Receber resposta
    if let Some(frame) = client.recv().await {
        let text = String::from_utf8_lossy(&frame.payload);
        println!("Received: {}", text);
    }

    // Fechar conex√£o
    client.close().await?;

    Ok(())
}</code></pre>

                <h3>Servidor de Chat</h3>
                <pre><code>use avx_websocket::{WebSocketServer, Frame, OpCode};
use std::sync::Arc;
use tokio::sync::Mutex;

type Clients = Arc<Mutex<Vec<Connection>>>;

#[tokio::main]
async fn main() -> Result<()> {
    let server = WebSocketServer::bind("0.0.0.0:8080").await?;
    let clients: Clients = Arc::new(Mutex::new(Vec::new()));

    println!("Chat server running on :8080");

    while let Ok((mut connection, addr)) = server.accept().await {
        let clients = clients.clone();

        // Adicionar novo cliente
        {
            let mut clients = clients.lock().await;
            clients.push(connection.clone());
        }

        tokio::spawn(async move {
            println!("User joined: {}", addr);

            while let Some(frame) = connection.recv().await {
                if frame.opcode == OpCode::Text {
                    // Broadcast para todos os clientes
                    let mut clients = clients.lock().await;
                    for client in clients.iter_mut() {
                        let _ = client.send(frame.clone()).await;
                    }
                }
            }

            println!("User left: {}", addr);
        });
    }

    Ok(())
}</code></pre>

                <h3>Cliente com Auto-Reconnect</h3>
                <pre><code>use avx_websocket::WebSocketClient;
use std::time::Duration;

async fn connect_with_retry(url: &str) -> WebSocketClient {
    loop {
        match WebSocketClient::connect(url).await {
            Ok(client) => {
                println!("Connected!");
                return client;
            }
            Err(e) => {
                eprintln!("Connection failed: {}, retrying...", e);
                tokio::time::sleep(Duration::from_secs(5)).await;
            }
        }
    }
}

#[tokio::main]
async fn main() -> Result<()> {
    let mut client = connect_with_retry("ws://localhost:8080").await;

    // Usar cliente...

    Ok(())
}</code></pre>

                <h3>Fragmenta√ß√£o de Mensagens Grandes</h3>
                <pre><code>use avx_websocket::{Frame, OpCode};

async fn send_large_message(connection: &mut Connection, data: Vec<u8>) -> Result<()> {
    const CHUNK_SIZE: usize = 4096;

    for (i, chunk) in data.chunks(CHUNK_SIZE).enumerate() {
        let is_first = i == 0;
        let is_last = (i + 1) * CHUNK_SIZE >= data.len();

        let opcode = if is_first {
            OpCode::Binary
        } else {
            OpCode::Continuation
        };

        let mut frame = Frame::new(opcode, chunk.to_vec());
        frame.fin = is_last;

        connection.send(frame).await?;
    }

    Ok(())
}</code></pre>

                <h3>WebSocket com TLS (WSS)</h3>
                <pre><code>use avx_websocket::{WebSocketServer, TlsConfig};

let tls = TlsConfig::builder()
    .cert_path("cert.pem")
    .key_path("key.pem")
    .build();

let server = WebSocketServer::builder()
    .bind("0.0.0.0:443")
    .tls(tls)
    .serve()
    .await?;</code></pre>

                <h3>Broadcast Server</h3>
                <pre><code>use avx_websocket::{WebSocketServer, Frame};
use tokio::sync::broadcast;

#[tokio::main]
async fn main() -> Result<()> {
    let server = WebSocketServer::bind("0.0.0.0:8080").await?;
    let (tx, _) = broadcast::channel::<Frame>(100);

    while let Ok((mut connection, _)) = server.accept().await {
        let mut rx = tx.subscribe();
        let tx = tx.clone();

        tokio::spawn(async move {
            // Task para receber e broadcast
            let recv_task = tokio::spawn(async move {
                while let Some(frame) = connection.recv().await {
                    let _ = tx.send(frame);
                }
            });

            // Task para enviar broadcasts
            let send_task = tokio::spawn(async move {
                while let Ok(frame) = rx.recv().await {
                    let _ = connection.send(frame).await;
                }
            });

            let _ = tokio::join!(recv_task, send_task);
        });
    }

    Ok(())
}</code></pre>

                <h3>WebSocket com Compress√£o</h3>
                <pre><code>use avx_websocket::{WebSocketServer, Extension};

let server = WebSocketServer::builder()
    .bind("0.0.0.0:8080")
    .extension(Extension::PerMessageDeflate)
    .serve()
    .await?;</code></pre>

                <h3>Heartbeat (Ping/Pong)</h3>
                <pre><code>use avx_websocket::{Connection, Frame, OpCode};
use std::time::Duration;

async fn heartbeat_loop(mut connection: Connection) {
    let mut interval = tokio::time::interval(Duration::from_secs(30));

    loop {
        interval.tick().await;

        let ping = Frame::new(OpCode::Ping, vec![]);
        if connection.send(ping).await.is_err() {
            break;
        }
    }
}</code></pre>
            </section>

            <section id="api" class="section fade-in">
                <h2>üìö Refer√™ncias da API</h2>

                <h3>Frame</h3>
                <div class="module-card">
                    <h4><code>Frame::new(opcode: OpCode, payload: Vec&lt;u8&gt;) -> Self</code></h4>
                    <p>Cria novo frame WebSocket com opcode e payload especificados.</p>
                </div>

                <div class="module-card">
                    <h4><code>Frame::text(text: &str) -> Self</code></h4>
                    <p>Cria frame de texto UTF-8.</p>
                </div>

                <div class="module-card">
                    <h4><code>Frame::binary(data: Vec&lt;u8&gt;) -> Self</code></h4>
                    <p>Cria frame de dados bin√°rios.</p>
                </div>

                <div class="module-card">
                    <h4><code>Frame::close(code: u16, reason: &str) -> Self</code></h4>
                    <p>Cria frame de fechamento com c√≥digo e raz√£o.</p>
                </div>

                <h3 class="mt-3">WebSocketServer</h3>
                <div class="module-card">
                    <h4><code>WebSocketServer::bind(addr: &str) -> Result&lt;Self&gt;</code></h4>
                    <p>Cria servidor WebSocket no endere√ßo especificado.</p>
                </div>

                <div class="module-card">
                    <h4><code>WebSocketServer::accept() -> Result&lt;(Connection, SocketAddr)&gt;</code></h4>
                    <p>Aceita nova conex√£o WebSocket.</p>
                </div>

                <h3 class="mt-3">WebSocketClient</h3>
                <div class="module-card">
                    <h4><code>WebSocketClient::connect(url: &str) -> Result&lt;Self&gt;</code></h4>
                    <p>Conecta ao servidor WebSocket especificado.</p>
                </div>

                <div class="module-card">
                    <h4><code>WebSocketClient::send(frame: Frame) -> Result&lt;()&gt;</code></h4>
                    <p>Envia frame pela conex√£o WebSocket.</p>
                </div>

                <div class="module-card">
                    <h4><code>WebSocketClient::recv() -> Option&lt;Frame&gt;</code></h4>
                    <p>Recebe pr√≥ximo frame da conex√£o.</p>
                </div>

                <div class="module-card">
                    <h4><code>WebSocketClient::close() -> Result&lt;()&gt;</code></h4>
                    <p>Fecha conex√£o WebSocket graciosamente.</p>
                </div>
            </section>

            <section id="performance" class="section fade-in">
                <h2>‚ö° Performance</h2>

                <div class="performance-chart">
                    <h3>Benchmarks - Throughput</h3>
                    <div class="chart-bar">
                        <div class="chart-label">Text Frames</div>
                        <div class="chart-track">
                            <div class="chart-fill" data-value="98" style="width: 0;">200k frames/s</div>
                        </div>
                    </div>
                    <div class="chart-bar">
                        <div class="chart-label">Binary Frames</div>
                        <div class="chart-track">
                            <div class="chart-fill" data-value="100" style="width: 0;">220k frames/s</div>
                        </div>
                    </div>
                    <div class="chart-bar">
                        <div class="chart-label">Ping/Pong</div>
                        <div class="chart-track">
                            <div class="chart-fill" data-value="95" style="width: 0;">180k ops/s</div>
                        </div>
                    </div>
                    <div class="chart-bar">
                        <div class="chart-label">Concurrent Connections</div>
                        <div class="chart-track">
                            <div class="chart-fill" data-value="92" style="width: 0;">50k connections</div>
                        </div>
                    </div>
                </div>

                <div class="performance-chart mt-3">
                    <h3>Lat√™ncia (p99)</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Opera√ß√£o</th>
                                <th>AVX WebSocket</th>
                                <th>Melhoria</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Frame Parsing</td>
                                <td>85 Œºs</td>
                                <td>6.2x mais r√°pido</td>
                            </tr>
                            <tr>
                                <td>Frame Serialization</td>
                                <td>92 Œºs</td>
                                <td>5.8x mais r√°pido</td>
                            </tr>
                            <tr>
                                <td>Ping/Pong RTT</td>
                                <td>180 Œºs</td>
                                <td>4.5x mais r√°pido</td>
                            </tr>
                            <tr>
                                <td>Handshake</td>
                                <td>1.2 ms</td>
                                <td>3.2x mais r√°pido</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <h3 class="mt-3">Caracter√≠sticas de Performance</h3>
                <div class="modules-grid">
                    <div class="module-card">
                        <h4>‚úÖ Zero-Copy Parsing</h4>
                        <p>Parsing de frames sem c√≥pias desnecess√°rias</p>
                    </div>
                    <div class="module-card">
                        <h4>‚úÖ Masking Otimizado</h4>
                        <p>Opera√ß√µes de masking SIMD-accelerated</p>
                    </div>
                    <div class="module-card">
                        <h4>‚úÖ Async I/O</h4>
                        <p>I/O ass√≠ncrono de alta performance</p>
                    </div>
                    <div class="module-card">
                        <h4>‚úÖ Connection Pooling</h4>
                        <p>Pool de conex√µes eficiente</p>
                    </div>
                </div>
            </section>

            <section id="usecases" class="section fade-in">
                <h2>üé¨ Casos de Uso</h2>

                <div class="module-card">
                    <h3>üí¨ Chat em Tempo Real</h3>
                    <p>Implemente sistemas de chat com comunica√ß√£o bidirecional instant√¢nea.</p>
                    <pre><code>let server = WebSocketServer::bind(":8080").await?;
// Broadcast messages para todos os clientes conectados</code></pre>
                </div>

                <div class="module-card mt-3">
                    <h3>üìä Streaming de Dados</h3>
                    <p>Transmita dados em tempo real para dashboards e sistemas de monitoramento.</p>
                    <pre><code>// Stream metrics em tempo real
connection.send(Frame::binary(metrics_data)).await?;</code></pre>
                </div>

                <div class="module-card mt-3">
                    <h3>üéÆ Jogos Multiplayer</h3>
                    <p>Sincronize estado de jogo entre m√∫ltiplos clientes com baixa lat√™ncia.</p>
                    <pre><code>// Broadcast game state updates
broadcast_to_players(game_state_frame).await?;</code></pre>
                </div>

                <div class="module-card mt-3">
                    <h3>üîî Notifica√ß√µes Push</h3>
                    <p>Envie notifica√ß√µes em tempo real para aplica√ß√µes web e m√≥veis.</p>
                    <pre><code>// Push notifications para usu√°rios conectados
connection.send(Frame::text(&notification_json)).await?;</code></pre>
                </div>
            </section>

            <section id="license" class="section fade-in">
                <h2>üìÑ Licen√ßa</h2>
                <p><strong>Copyright ¬© 2025 N√≠colas √Åvila - Todos os Direitos Reservados</strong></p>
                <p>Software Propriet√°rio - Veja <a href="../../LICENSE-PROPRIETARY.md">LICENSE-PROPRIETARY.md</a></p>
                <p class="mt-2">Para licenciamento comercial, entre em contato: <a href="mailto:nicolas@avila.inc">nicolas@avila.inc</a></p>
            </section>
        </div>
    </main>

    <footer>
        <div class="container">
            <div class="footer-content">
                <p>¬© 2025 N√≠colas √Åvila - Todos os Direitos Reservados</p>
                <div class="footer-links">
                    <a href="https://avila.inc">Contato</a>
                    <a href="https://docs.avila.inc">Documenta√ß√£o</a>
                    <a href="../../LICENSE-PROPRIETARY.md">Licen√ßa</a>
                </div>
            </div>
        </div>
    </footer>

    <script src="../assets/js/main.js"></script>
</body>
</html>
