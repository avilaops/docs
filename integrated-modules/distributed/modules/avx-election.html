<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>avx-election - Avx Documentation</title>
    <link rel="stylesheet" href="../assets/css/styles.css">
</head>
<body>
    <header>
        <div class="header-container">
            <div class="logo">
                <a href="../index.html" style="color: white; text-decoration: none; display: flex; align-items: center; gap: 0.5rem;">
                    <span>‚ö°</span>
                    <span>Avx Distributed Systems</span>
                </a>
            </div>
            <div class="nav-controls">
                <button class="theme-toggle" onclick="toggleTheme()">‚òÄÔ∏è Modo Claro</button>
                <div class="language-selector">
                    <button class="language-btn" onclick="toggleLanguageDropdown()">üåç Idioma</button>
                    <div class="language-dropdown"></div>
                </div>
            </div>
        </div>
    </header>

    <div class="container">
        <div style="margin-bottom: 2rem;">
            <a href="../index.html" style="color: var(--primary-orange);">‚Üê Voltar</a>
        </div>

        <!-- Module Header -->
        <section class="section">
            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                <span style="font-size: 3rem;">üëë</span>
                <h1 class="section-title">avx-election</h1>
            </div>
            <p style="font-size: 1.2rem; opacity: 0.8;">
                Algoritmos de elei√ß√£o de l√≠der distribu√≠do para coordena√ß√£o e consenso.
            </p>
        </section>

        <!-- Overview -->
        <section class="section">
            <h2 class="section-title">Vis√£o Geral</h2>
            <div class="code-block">
                <p><strong>avx-election</strong> implementa algoritmos cl√°ssicos de elei√ß√£o de l√≠der:</p>
                <ul>
                    <li>üëë <strong>Bully Algorithm</strong> - Elei√ß√£o baseada em IDs (maior vence)</li>
                    <li>üíç <strong>Ring Algorithm</strong> - Elei√ß√£o em topologia de anel</li>
                    <li>üéØ <strong>Paxos-based</strong> - Elei√ß√£o com consenso Paxos</li>
                    <li>üîÑ <strong>Auto-Recovery</strong> - Re-elei√ß√£o autom√°tica em falhas</li>
                    <li>‚è±Ô∏è <strong>Timeout Detection</strong> - Detec√ß√£o de l√≠der inativo</li>
                    <li>üìä <strong>M√©tricas de Elei√ß√£o</strong> - Rastreamento de mudan√ßas de l√≠der</li>
                    <li>üîí <strong>Split-Brain Prevention</strong> - Preven√ß√£o de m√∫ltiplos l√≠deres</li>
                    <li>‚ö° <strong>Fast Election</strong> - Elei√ß√£o em milissegundos</li>
                </ul>
            </div>
        </section>

        <!-- Types -->
        <section class="section">
            <h2 class="section-title">Tipos Dispon√≠veis</h2>
            <table class="api-table">
                <thead>
                    <tr>
                        <th>Tipo</th>
                        <th>Descri√ß√£o</th>
                        <th>Uso Principal</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>ElectionCoordinator</code></td>
                        <td>Coordenador de elei√ß√µes</td>
                        <td>Gerenciamento de elei√ß√µes</td>
                    </tr>
                    <tr>
                        <td><code>BullyAlgorithm</code></td>
                        <td>Algoritmo Bully</td>
                        <td>Elei√ß√£o por prioridade</td>
                    </tr>
                    <tr>
                        <td><code>RingAlgorithm</code></td>
                        <td>Algoritmo de Anel</td>
                        <td>Topologia circular</td>
                    </tr>
                    <tr>
                        <td><code>NodeId</code></td>
                        <td>Identificador de n√≥</td>
                        <td>Identifica√ß√£o √∫nica</td>
                    </tr>
                    <tr>
                        <td><code>ElectionState</code></td>
                        <td>Estado da elei√ß√£o</td>
                        <td>Tracking de progresso</td>
                    </tr>
                    <tr>
                        <td><code>LeaderInfo</code></td>
                        <td>Informa√ß√£o do l√≠der</td>
                        <td>Dados do l√≠der atual</td>
                    </tr>
                    <tr>
                        <td><code>ElectionMetrics</code></td>
                        <td>M√©tricas de elei√ß√µes</td>
                        <td>An√°lise e auditoria</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <!-- Examples -->
        <section class="section">
            <h2 class="section-title">Exemplos de Uso</h2>
            
            <h3 style="color: var(--primary-orange); margin-top: 2rem;">Bully Algorithm - B√°sico</h3>
            <div class="code-block">
                <pre><code>use avx_election::{ElectionCoordinator, BullyAlgorithm, NodeId};

let nodes = vec![
    NodeId::new(1),
    NodeId::new(2),
    NodeId::new(3),
];

let mut coordinator = ElectionCoordinator::new(
    NodeId::new(2),
    BullyAlgorithm::new()
);

// Iniciar elei√ß√£o
coordinator.start_election(&nodes)?;

// N√≥ 3 ser√° eleito (maior ID)
let leader = coordinator.get_leader()?;
assert_eq!(leader.id(), NodeId::new(3));</code></pre>
            </div>

            <h3 style="color: var(--primary-orange); margin-top: 2rem;">Detec√ß√£o de Falha e Re-elei√ß√£o</h3>
            <div class="code-block">
                <pre><code>use avx_election::{ElectionCoordinator, NodeId};
use std::time::Duration;

let mut coordinator = ElectionCoordinator::new(
    NodeId::new(1),
    BullyAlgorithm::new()
);

// Configurar timeout de heartbeat
coordinator.set_heartbeat_timeout(Duration::from_secs(5));

// L√≠der atual
let leader = coordinator.get_leader()?;

// Simular falha do l√≠der (sem heartbeat)
std::thread::sleep(Duration::from_secs(6));

// Re-elei√ß√£o autom√°tica √© disparada
coordinator.check_leader_health()?;

// Novo l√≠der foi eleito
let new_leader = coordinator.get_leader()?;
assert_ne!(leader, new_leader);</code></pre>
            </div>

            <h3 style="color: var(--primary-orange); margin-top: 2rem;">Ring Algorithm</h3>
            <div class="code-block">
                <pre><code>use avx_election::{RingAlgorithm, NodeId};

let nodes = vec![
    NodeId::new(5),
    NodeId::new(3),
    NodeId::new(7),
    NodeId::new(1),
];

let mut ring = RingAlgorithm::new(NodeId::new(3));

// Organizar n√≥s em anel
ring.setup_ring(&nodes)?;

// Iniciar elei√ß√£o
ring.start_election()?;

// Mensagem viaja pelo anel
// N√≥ com maior ID (7) ser√° eleito
let leader = ring.get_elected_leader()?;
assert_eq!(leader, NodeId::new(7));</code></pre>
            </div>

            <h3 style="color: var(--primary-orange); margin-top: 2rem;">Callbacks de Elei√ß√£o</h3>
            <div class="code-block">
                <pre><code>use avx_election::{ElectionCoordinator, ElectionEvent};

let mut coordinator = ElectionCoordinator::new(
    NodeId::new(1),
    BullyAlgorithm::new()
);

// Registrar callback para eventos
coordinator.on_election_event(|event| {
    match event {
        ElectionEvent::ElectionStarted => {
            println!("Elei√ß√£o iniciada!");
        }
        ElectionEvent::NewLeaderElected(leader_id) => {
            println!("Novo l√≠der: {:?}", leader_id);
        }
        ElectionEvent::LeaderFailed(old_leader) => {
            println!("L√≠der falhou: {:?}", old_leader);
        }
    }
});</code></pre>
            </div>

            <h3 style="color: var(--primary-orange); margin-top: 2rem;">M√©tricas de Elei√ß√£o</h3>
            <div class="code-block">
                <pre><code>use avx_election::ElectionMetrics;

let metrics = coordinator.get_metrics();

println!("Total de elei√ß√µes: {}", metrics.total_elections);
println!("Tempo m√©dio: {:?}", metrics.average_election_time);
println!("Mudan√ßas de l√≠der: {}", metrics.leader_changes);
println!("Falhas detectadas: {}", metrics.leader_failures);

// An√°lise de estabilidade
if metrics.leader_changes > 10 {
    println!("AVISO: Muitas mudan√ßas de l√≠der!");
}</code></pre>
            </div>
        </section>

        <!-- API Reference -->
        <section class="section">
            <h2 class="section-title">Refer√™ncia da API</h2>
            
            <h3 style="color: var(--primary-orange);">ElectionCoordinator</h3>
            <table class="api-table">
                <thead>
                    <tr>
                        <th>M√©todo</th>
                        <th>Descri√ß√£o</th>
                        <th>Retorno</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>new(node_id, algorithm)</code></td>
                        <td>Cria coordenador de elei√ß√£o</td>
                        <td><code>ElectionCoordinator</code></td>
                    </tr>
                    <tr>
                        <td><code>start_election(nodes)</code></td>
                        <td>Inicia processo de elei√ß√£o</td>
                        <td><code>Result&lt;()&gt;</code></td>
                    </tr>
                    <tr>
                        <td><code>get_leader()</code></td>
                        <td>Obt√©m l√≠der atual</td>
                        <td><code>Result&lt;LeaderInfo&gt;</code></td>
                    </tr>
                    <tr>
                        <td><code>is_leader()</code></td>
                        <td>Verifica se √© o l√≠der</td>
                        <td><code>bool</code></td>
                    </tr>
                    <tr>
                        <td><code>check_leader_health()</code></td>
                        <td>Verifica sa√∫de do l√≠der</td>
                        <td><code>Result&lt;()&gt;</code></td>
                    </tr>
                    <tr>
                        <td><code>set_heartbeat_timeout(d)</code></td>
                        <td>Define timeout de heartbeat</td>
                        <td><code>()</code></td>
                    </tr>
                    <tr>
                        <td><code>get_metrics()</code></td>
                        <td>Obt√©m m√©tricas</td>
                        <td><code>ElectionMetrics</code></td>
                    </tr>
                </tbody>
            </table>
        </section>

        <!-- Performance -->
        <section class="section">
            <h2 class="section-title">Performance</h2>
            <div class="animation-showcase">
                <div class="animated-element">
                    üëë Elei√ß√£o Ultra-R√°pida
                </div>
                <div style="margin-top: 2rem; text-align: left; max-width: 800px; margin-left: auto; margin-right: auto;">
                    <h3 style="color: var(--primary-orange);">Benchmarks</h3>
                    <table class="api-table">
                        <thead>
                            <tr>
                                <th>Opera√ß√£o</th>
                                <th>Tempo</th>
                                <th>Throughput</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Bully Election (5 n√≥s)</td>
                                <td>~2ms</td>
                                <td>500 elei√ß√µes/s</td>
                            </tr>
                            <tr>
                                <td>Ring Election (10 n√≥s)</td>
                                <td>~5ms</td>
                                <td>200 elei√ß√µes/s</td>
                            </tr>
                            <tr>
                                <td>Leader Check</td>
                                <td>~100Œºs</td>
                                <td>10K checks/s</td>
                            </tr>
                            <tr>
                                <td>Failure Detection</td>
                                <td>~5ms</td>
                                <td>200 detec√ß√µes/s</td>
                            </tr>
                        </tbody>
                    </table>

                    <h3 style="color: var(--primary-orange); margin-top: 2rem;">Otimiza√ß√µes</h3>
                    <ul>
                        <li>‚úÖ Mensagens paralelas no Bully</li>
                        <li>‚úÖ Cache de topologia no Ring</li>
                        <li>‚úÖ Heartbeat batching</li>
                        <li>‚úÖ Lock-free leader tracking</li>
                        <li>‚úÖ Fast-path para l√≠der est√°vel</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Use Cases -->
        <section class="section">
            <h2 class="section-title">Casos de Uso</h2>
            
            <div class="module-card animated-element">
                <h3 class="module-title">üóÑÔ∏è Cluster de Banco de Dados</h3>
                <p>Eleja um n√≥ master para coordenar escritas em um cluster de banco de dados.</p>
                <div class="code-block">
                    <pre><code>let mut coordinator = ElectionCoordinator::new(
    db_node_id,
    BullyAlgorithm::new()
);

coordinator.start_election(&cluster_nodes)?;

if coordinator.is_leader() {
    // Este n√≥ √© o master
    start_accepting_writes();
} else {
    // N√≥ replica
    start_replication_from_master();
}</code></pre>
                </div>
            </div>

            <div class="module-card animated-element" style="margin-top: 2rem;">
                <h3 class="module-title">‚öôÔ∏è Coordena√ß√£o de Workers</h3>
                <p>Um l√≠der distribui tarefas para workers no cluster.</p>
                <div class="code-block">
                    <pre><code>coordinator.on_election_event(|event| {
    if let ElectionEvent::NewLeaderElected(leader) = event {
        if coordinator.is_leader() {
            // Assumir papel de coordenador
            start_task_distribution();
        } else {
            // Aguardar tarefas do l√≠der
            connect_to_leader(leader);
        }
    }
});</code></pre>
                </div>
            </div>

            <div class="module-card animated-element" style="margin-top: 2rem;">
                <h3 class="module-title">üîÑ Alta Disponibilidade</h3>
                <p>Failover autom√°tico quando o l√≠der cai.</p>
                <div class="code-block">
                    <pre><code>// Monitoramento cont√≠nuo
loop {
    coordinator.check_leader_health()?;
    
    if !coordinator.has_leader() {
        // L√≠der caiu - iniciar elei√ß√£o
        coordinator.start_election(&nodes)?;
    }
    
    tokio::time::sleep(Duration::from_secs(1)).await;
}</code></pre>
                </div>
            </div>
        </section>

        <!-- License -->
        <section class="section">
            <h2 class="section-title">Licen√ßa</h2>
            <div class="code-block">
                <p><strong>Copyright ¬© 2025 N√≠colas √Åvila - Todos os Direitos Reservados</strong></p>
                <p>Este m√≥dulo faz parte do ecossistema propriet√°rio Avx.</p>
                <p>Para uso comercial, entre em contato:</p>
                <ul>
                    <li>üìß Email: nicolas@avila.inc</li>
                    <li>üåê Website: https://avila.inc</li>
                </ul>
            </div>
        </section>
    </div>

    <footer>
        <p>Copyright ¬© 2025 N√≠colas √Åvila - Todos os Direitos Reservados</p>
        <p>avx-election - Software Propriet√°rio</p>
    </footer>

    <script src="../assets/js/main.js"></script>
</body>
</html>