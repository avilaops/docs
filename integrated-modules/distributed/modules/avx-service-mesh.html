<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>avx-service-mesh - Avx Documentation</title>
    <link rel="stylesheet" href="../assets/css/styles.css">
</head>
<body>
    <header>
        <div class="header-container">
            <div class="logo">
                <a href="../index.html" style="color: white; text-decoration: none; display: flex; align-items: center; gap: 0.5rem;">
                    <span>‚ö°</span>
                    <span>Avx Distributed Systems</span>
                </a>
            </div>
            <div class="nav-controls">
                <button class="theme-toggle" onclick="toggleTheme()">‚òÄÔ∏è Modo Claro</button>
                <div class="language-selector">
                    <button class="language-btn" onclick="toggleLanguageDropdown()">üåç Idioma</button>
                    <div class="language-dropdown"></div>
                </div>
            </div>
        </div>
    </header>

    <div class="container">
        <div style="margin-bottom: 2rem;">
            <a href="../index.html" style="color: var(--primary-orange);">‚Üê Voltar</a>
        </div>

        <!-- Module Header -->
        <section class="section">
            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                <span style="font-size: 3rem;">üï∏Ô∏è</span>
                <h1 class="section-title">avx-service-mesh</h1>
            </div>
            <p style="font-size: 1.2rem; opacity: 0.8;">
                Malha de servi√ßos empresarial com descoberta, load balancing, circuit breaker e observabilidade completa.
            </p>
        </section>

        <!-- Overview -->
        <section class="section">
            <h2 class="section-title">Vis√£o Geral</h2>
            <div class="code-block">
                <p><strong>avx-service-mesh</strong> fornece infraestrutura completa para microservi√ßos:</p>
                <ul>
                    <li>üîç <strong>Service Discovery</strong> - Registro e descoberta autom√°tica de servi√ßos</li>
                    <li>‚öñÔ∏è <strong>Load Balancing</strong> - Round Robin, Least Connections, Weighted, Random</li>
                    <li>üîå <strong>Circuit Breaker</strong> - Prote√ß√£o contra falhas em cascata</li>
                    <li>üíö <strong>Health Checks</strong> - Monitoramento cont√≠nuo de sa√∫de</li>
                    <li>üîê <strong>mTLS & Security</strong> - Comunica√ß√£o segura entre servi√ßos</li>
                    <li>üìä <strong>Distributed Tracing</strong> - Rastreamento de requests distribu√≠dos</li>
                    <li>üö¶ <strong>Traffic Management</strong> - Roteamento avan√ßado e canary deployments</li>
                    <li>üìà <strong>M√©tricas</strong> - Observabilidade completa de servi√ßos</li>
                </ul>
            </div>
        </section>

        <!-- Types -->
        <section class="section">
            <h2 class="section-title">Tipos Dispon√≠veis</h2>
            <table class="api-table">
                <thead>
                    <tr>
                        <th>Tipo</th>
                        <th>Descri√ß√£o</th>
                        <th>Uso Principal</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>ServiceMesh</code></td>
                        <td>Orquestrador principal da mesh</td>
                        <td>Gerenciamento centralizado</td>
                    </tr>
                    <tr>
                        <td><code>ServiceRegistry</code></td>
                        <td>Registro de servi√ßos</td>
                        <td>Discovery e cat√°logo</td>
                    </tr>
                    <tr>
                        <td><code>ServiceEndpoint</code></td>
                        <td>Informa√ß√£o de endpoint</td>
                        <td>Host, porta, protocolo</td>
                    </tr>
                    <tr>
                        <td><code>LoadBalancer</code></td>
                        <td>Balanceador de carga</td>
                        <td>Distribui√ß√£o de tr√°fego</td>
                    </tr>
                    <tr>
                        <td><code>CircuitBreaker</code></td>
                        <td>Disjuntor de circuito</td>
                        <td>Prote√ß√£o contra falhas</td>
                    </tr>
                    <tr>
                        <td><code>HealthMonitor</code></td>
                        <td>Monitor de sa√∫de</td>
                        <td>Health checks cont√≠nuos</td>
                    </tr>
                    <tr>
                        <td><code>TraceCollector</code></td>
                        <td>Coletor de traces</td>
                        <td>Rastreamento distribu√≠do</td>
                    </tr>
                    <tr>
                        <td><code>SecurityManager</code></td>
                        <td>Gerenciador de seguran√ßa</td>
                        <td>mTLS e autentica√ß√£o</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <!-- Examples -->
        <section class="section">
            <h2 class="section-title">Exemplos de Uso</h2>
            
            <h3 style="color: var(--primary-orange); margin-top: 2rem;">Configura√ß√£o B√°sica</h3>
            <div class="code-block">
                <pre><code>use avx_service_mesh::{ServiceMesh, MeshConfig};

let config = MeshConfig {
    discovery_enabled: true,
    circuit_breaker_enabled: true,
    health_check_interval_ms: 5000,
    load_balancer_strategy: Strategy::RoundRobin,
    security_enabled: true,
    tracing_enabled: true,
};

let mesh = ServiceMesh::with_config(config);</code></pre>
            </div>

            <h3 style="color: var(--primary-orange); margin-top: 2rem;">Registrar Servi√ßos</h3>
            <div class="code-block">
                <pre><code>use avx_service_mesh::{ServiceEndpoint, Protocol};

let endpoint = ServiceEndpoint {
    id: "user-service-1".to_string(),
    host: "10.0.1.100".to_string(),
    port: 8080,
    protocol: Protocol::Http,
    metadata: BTreeMap::new(),
    weight: 100,
};

mesh.register_service(endpoint)?;

// Registrar m√∫ltiplas inst√¢ncias
for i in 0..5 {
    let endpoint = ServiceEndpoint {
        id: format!("api-service-{}", i),
        host: format!("10.0.2.{}", 100 + i),
        port: 8080,
        protocol: Protocol::Https,
        metadata: BTreeMap::new(),
        weight: 100,
    };
    mesh.register_service(endpoint)?;
}</code></pre>
            </div>

            <h3 style="color: var(--primary-orange); margin-top: 2rem;">Load Balancing</h3>
            <div class="code-block">
                <pre><code>use avx_service_mesh::{LoadBalancer, Strategy};

// Criar load balancer com estrat√©gia
let mut lb = LoadBalancer::new(Strategy::LeastConnections);

// Adicionar endpoints
lb.add_endpoint(endpoint1);
lb.add_endpoint(endpoint2);
lb.add_endpoint(endpoint3);

// Selecionar pr√≥ximo endpoint (automaticamente escolhe o melhor)
let selected = lb.select_endpoint()?;

println!("Roteando para: {}:{}", selected.host, selected.port);</code></pre>
            </div>

            <h3 style="color: var(--primary-orange); margin-top: 2rem;">Circuit Breaker</h3>
            <div class="code-block">
                <pre><code>use avx_service_mesh::CircuitBreaker;

let mut breaker = CircuitBreaker::new(
    5,      // threshold: 5 falhas consecutivas
    30000,  // timeout: 30 segundos
);

// Executar opera√ß√£o protegida
match breaker.call(|| {
    // Chamada ao servi√ßo
    call_remote_service()
}) {
    Ok(result) => println!("Sucesso: {:?}", result),
    Err(e) => {
        if breaker.is_open() {
            println!("Circuit aberto - falha r√°pida");
        }
    }
}</code></pre>
            </div>

            <h3 style="color: var(--primary-orange); margin-top: 2rem;">Health Monitoring</h3>
            <div class="code-block">
                <pre><code>use avx_service_mesh::{HealthMonitor, HealthStatus};

let mut monitor = HealthMonitor::new();

// Registrar endpoints para monitoramento
monitor.register_endpoint("api-service-1", "10.0.1.100:8080");
monitor.register_endpoint("api-service-2", "10.0.1.101:8080");

// Iniciar health checks peri√≥dicos
monitor.start_monitoring(5000)?; // Checar a cada 5 segundos

// Verificar status
let status = monitor.get_status("api-service-1")?;
if status == HealthStatus::Healthy {
    println!("Servi√ßo saud√°vel");
}</code></pre>
            </div>
        </section>

        <!-- API Reference -->
        <section class="section">
            <h2 class="section-title">Refer√™ncia da API</h2>
            
            <h3 style="color: var(--primary-orange);">ServiceMesh</h3>
            <table class="api-table">
                <thead>
                    <tr>
                        <th>M√©todo</th>
                        <th>Descri√ß√£o</th>
                        <th>Retorno</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>new()</code></td>
                        <td>Cria mesh com config padr√£o</td>
                        <td><code>ServiceMesh</code></td>
                    </tr>
                    <tr>
                        <td><code>with_config(config)</code></td>
                        <td>Cria mesh com config customizada</td>
                        <td><code>ServiceMesh</code></td>
                    </tr>
                    <tr>
                        <td><code>register_service(endpoint)</code></td>
                        <td>Registra novo servi√ßo</td>
                        <td><code>Result&lt;()&gt;</code></td>
                    </tr>
                    <tr>
                        <td><code>discover_service(id)</code></td>
                        <td>Descobre servi√ßo por ID</td>
                        <td><code>Option&lt;ServiceEndpoint&gt;</code></td>
                    </tr>
                    <tr>
                        <td><code>route_request(service_id)</code></td>
                        <td>Roteia request com LB</td>
                        <td><code>Result&lt;ServiceEndpoint&gt;</code></td>
                    </tr>
                    <tr>
                        <td><code>get_health_status(id)</code></td>
                        <td>Obt√©m status de sa√∫de</td>
                        <td><code>HealthStatus</code></td>
                    </tr>
                </tbody>
            </table>

            <h3 style="color: var(--primary-orange); margin-top: 2rem;">LoadBalancer</h3>
            <table class="api-table">
                <thead>
                    <tr>
                        <th>M√©todo</th>
                        <th>Descri√ß√£o</th>
                        <th>Retorno</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>new(strategy)</code></td>
                        <td>Cria LB com estrat√©gia</td>
                        <td><code>LoadBalancer</code></td>
                    </tr>
                    <tr>
                        <td><code>add_endpoint(endpoint)</code></td>
                        <td>Adiciona endpoint ao pool</td>
                        <td><code>()</code></td>
                    </tr>
                    <tr>
                        <td><code>select_endpoint()</code></td>
                        <td>Seleciona pr√≥ximo endpoint</td>
                        <td><code>Option&lt;ServiceEndpoint&gt;</code></td>
                    </tr>
                    <tr>
                        <td><code>remove_endpoint(id)</code></td>
                        <td>Remove endpoint do pool</td>
                        <td><code>Result&lt;()&gt;</code></td>
                    </tr>
                </tbody>
            </table>
        </section>

        <!-- Performance -->
        <section class="section">
            <h2 class="section-title">Performance</h2>
            <div class="animation-showcase">
                <div class="animated-element">
                    üï∏Ô∏è Mesh de Alta Performance
                </div>
                <div style="margin-top: 2rem; text-align: left; max-width: 800px; margin-left: auto; margin-right: auto;">
                    <h3 style="color: var(--primary-orange);">Benchmarks</h3>
                    <table class="api-table">
                        <thead>
                            <tr>
                                <th>Opera√ß√£o</th>
                                <th>Tempo</th>
                                <th>Throughput</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Service Discovery</td>
                                <td>~100ns</td>
                                <td>10M lookups/s</td>
                            </tr>
                            <tr>
                                <td>Load Balancer Select</td>
                                <td>~50ns</td>
                                <td>20M selections/s</td>
                            </tr>
                            <tr>
                                <td>Circuit Breaker Check</td>
                                <td>~30ns</td>
                                <td>33M checks/s</td>
                            </tr>
                            <tr>
                                <td>Health Check</td>
                                <td>~1ms</td>
                                <td>1000 checks/s</td>
                            </tr>
                        </tbody>
                    </table>

                    <h3 style="color: var(--primary-orange); margin-top: 2rem;">Otimiza√ß√µes</h3>
                    <ul>
                        <li>‚úÖ Lock-free service registry</li>
                        <li>‚úÖ Zero-allocation load balancing</li>
                        <li>‚úÖ Async health checks com Tokio</li>
                        <li>‚úÖ Connection pooling autom√°tico</li>
                        <li>‚úÖ Cache de rotas com TTL</li>
                        <li>‚úÖ Batching de m√©tricas</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Use Cases -->
        <section class="section">
            <h2 class="section-title">Casos de Uso</h2>
            
            <div class="module-card animated-element">
                <h3 class="module-title">üè¢ Arquitetura de Microservi√ßos</h3>
                <p>Implemente comunica√ß√£o robusta entre dezenas ou centenas de microservi√ßos.</p>
                <div class="code-block">
                    <pre><code>let mesh = ServiceMesh::new();

// Registrar todos os servi√ßos
mesh.register_service(user_service)?;
mesh.register_service(order_service)?;
mesh.register_service(payment_service)?;
mesh.register_service(notification_service)?;

// Mesh gerencia automaticamente:
// - Descoberta
// - Load balancing
// - Health checks
// - Circuit breaking</code></pre>
                </div>
            </div>

            <div class="module-card animated-element" style="margin-top: 2rem;">
                <h3 class="module-title">üîÑ Canary Deployments</h3>
                <p>Implemente deploys graduais com roteamento de tr√°fego controlado.</p>
                <div class="code-block">
                    <pre><code>// Vers√£o antiga (90% do tr√°fego)
mesh.register_service(ServiceEndpoint {
    id: "api-v1".to_string(),
    weight: 90,
    ..
});

// Vers√£o nova (10% do tr√°fego)
mesh.register_service(ServiceEndpoint {
    id: "api-v2-canary".to_string(),
    weight: 10,
    ..
});

// Load balancer respeita os pesos automaticamente</code></pre>
                </div>
            </div>

            <div class="module-card animated-element" style="margin-top: 2rem;">
                <h3 class="module-title">üõ°Ô∏è Prote√ß√£o contra Falhas</h3>
                <p>Circuit breakers protegem a arquitetura contra falhas em cascata.</p>
                <div class="code-block">
                    <pre><code>// Configurar circuit breaker por servi√ßo
let breaker = CircuitBreaker::new(5, 30000);

// Se o servi√ßo falhar 5 vezes:
// - Circuit abre automaticamente
// - Requests falham rapidamente (fail-fast)
// - Ap√≥s 30s, tenta novamente (half-open)
// - Se sucesso, volta ao normal (closed)</code></pre>
                </div>
            </div>
        </section>

        <!-- License -->
        <section class="section">
            <h2 class="section-title">Licen√ßa</h2>
            <div class="code-block">
                <p><strong>Copyright ¬© 2025 N√≠colas √Åvila - Todos os Direitos Reservados</strong></p>
                <p>Este m√≥dulo faz parte do ecossistema propriet√°rio Avx.</p>
                <p>Para uso comercial, entre em contato:</p>
                <ul>
                    <li>üìß Email: nicolas@avila.inc</li>
                    <li>üåê Website: https://avila.inc</li>
                </ul>
            </div>
        </section>
    </div>

    <footer>
        <p>Copyright ¬© 2025 N√≠colas √Åvila - Todos os Direitos Reservados</p>
        <p>avx-service-mesh - Software Propriet√°rio</p>
    </footer>

    <script src="../assets/js/main.js"></script>
</body>
</html>